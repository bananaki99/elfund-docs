BACKEND
=======

Στο κεφάλαιο αυτό περιγράφονται οι αναλυτικές προδιαγραφές του πληροφοριακού συστήματος **ELFUND**.

DBDat
-----
To **DBDat** είναι το σχήμα δεδομένων για την απευθείας εισαγωγή στοιχείων στους πίνακες της βάσης δεδομένων του **ELFUND**.  Το πρότυπο πληροφοριών που βασίζεται η δομή του σχήματος περιγράφεται στο κεφάλαιο :doc:`model`.  Περιέχει τέσσερις γενικές κατηγορίες στοιχείων (REF, KEY, BSI, INC).  Στον παρακάτω πίνακα δίνονται σύνδεσμοι για φόρτωση των παρακάτω αρχείων για κάθε κατηγορία:

* Το DATA_MODEL που περιγράφει τη δομή κάθε κατηγορίας στοιχείων (:doc:`model`)
* Υπόδειγμα Excel για υποβολή στοιχείων με μορφή Excel 
* JSON schema που έχει δημιουργηθεί σύμφωνα με τις προδιαγραφές JSON Schema Core, JSON Schema Validation και OpenAPI για υποβολη στοιχείων με μορφή json.

+-------------------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------+----------------------------------------------------------------+
| Κατηγορία                                 | Δομή                                                             | Υπόδειγμα Excel                                                    | JSON Schema                                                    |
+===========================================+==================================================================+====================================================================+================================================================+
| REF                                       | :download:`REF </_files/dbdat/model/REF_DATAMODEL.xlsx>`         | :download:`REF </_files/dbdat/template/REF_TEMPLATE.xlsx>`         | :download:`REF </_files/dbdat/schema/REF_SCHEMA.json>`         |
+-------------------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------+----------------------------------------------------------------+
| KEY                                       | :download:`KEY </_files/dbdat/model/KEY_DATAMODEL.xlsx>`         | :download:`KEY </_files/dbdat/template/KEY_TEMPLATE.xlsx>`         | :download:`KEY </_files/dbdat/schema/KEY_SCHEMA.json>`         |
+-------------------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------+----------------------------------------------------------------+
| BSI                                       | :download:`BSI </_files/dbdat/model/BSI_DATAMODEL.xlsx>`         | :download:`BSI </_files/dbdat/template/BSI_TEMPLATE.xlsx>`         | :download:`BSI </_files/dbdat/schema/BSI_SCHEMA.json>`         |
+-------------------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------+----------------------------------------------------------------+
| INC                                       | :download:`INC </_files/dbdat/model/INC_DATAMODEL.xlsx>`         | :download:`INC </_files/dbdat/template/INC_TEMPLATE.xlsx>`         | :download:`INC </_files/dbdat/schema/INC_SCHEMA.json>`         |
+-------------------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------+----------------------------------------------------------------+

Σημειώνεται ότι υποβαλλόμενα στοιχεια σε μορφή excel θα πρέπει να μετατρέπονται από το **ELFUND**
σε μορφή json σύμφωνα με ένα από τα παραπάνω json-schema της κατηγορίας των στοιχείων.

Πίνακες βάσης
-------------
Σε κάθε πίνακα της βάσης δεδομένων που έχει δημιουργηθεί για να αποθηκεύει τα
στοιχεία DBDAT θα πρέπει να εισάγονται:

* δύο παραγόμενες διαστάσεις που δίνουν πληροφόρηση για το από πότε μέχρι πότε
  είναι επίσημα τα στοιχεία της εγγραφής.  Οι διαστάσεις αυτές θα έχουν το
  όνομα OFFICIAL_FROM, OFFICIAL_TO με ακρώνυμα OFFCL_FRM, OFFCL_T.  Για
  παράδειγμα αν οι διαστασεις ενός πίνακα του **DBDat** είναι οι
  SRC_ORG,SRC_PSN,SRC_TYP,ID,VLD_FRM,VLD_T τότε οι διαστάσεις του αντίστοιχου
  πίνακα της βάσης θα πρέπει να είναι
  OFFCL_FRM,OFFCL_T,SRC_ORG,SRC_PSN,SRC_TYP,ID,VLD_FRM,VLD_T.

* μεταβλητή LOG που δίνει σύνδεσμο με το πίνακα LOG έτσι ώστε να μπορεί να
  διαπιστωθεί ποιος ευθύνεται για τις αλλαγές που υπάρχουν στις παρεχόμενες
  πληροφορίες των μεταβλητών της εγγραφής(εγγραφών).

Κανόνες Εισαγωγής Στοιχείων
---------------------------
TODO

API Άντλησης Στοιχείων από τη Βάση
----------------------------------
TODO


Δομή Δεδεμένων Πινάκων Βάσης
----------------------------
Η δομή δεδομένων των πινάκων της βάσης γίνεται με βάση το μοντέλο πληροφοριών
SDMX που περιγράφεται στο κεφάλαιο :doc:`model` και η απευθείας υποβολή
στοιχείων στη βάση γίνεται με βάση τις προδιαγραφές στο κεφάλαιο
:doc:`submission`. Δύο ειδών στοιχείων αποθηκεύονται στη βάση: εισερχόμενα
στοιχεία που περιλαμβανουν τρεις κατηγορίες στοιχείων και στοιχεία επικύρωσης
των εισερχόμενων αρχείων.

Εισερχόμενα Στοιχεία
--------------------

Για κάθε από τις τρεις κατηγορίες δεδομένων των εισερχόμενων στοιχείων ο παρακάτω πίνακας παρέχει τα ακόλουθα:

Κατηγορία
    Ονομασία της κατηγορίας δεδομένων αλλά και σύνδεσμος με την ενότητα που περιγράφει τα ακόλουθα για κάθε πίνακα:

    * Διαστάσεις του πίνακα

    * Μεταβλητές του πίνακα

    * Τα χαρακτηριστικά της κάθε μεταβλητής του πίνακα σε περίπτωση που υπάρχει διαφοροποίηση σε σχέση με τις οδηγίες στο :doc:`generic`.

    Στον τίτλο της κάθε διάστασης, μεταβλητής και χαρακτηριστικού δίνεται η ονομασία καθώς και σε παρένθεση ο κωδικός της ονομασίας σε περίπτωση που διαφέρει από την ονομασία."

Δομή
    Σύνδεσμος για φόρτωση του αντίστοιχου **DATA MODEL**.


Excel Template
    Σύνδεσμος για φόρτωση του EXCEL υποδείγματος για υποβολή στοιχείων με EXCEL μορφότυπο.

JSON Schema
    Σύνδεσμος για φόρτωση του **json** schema με βάση το οποίο σχηματίζονται στοιχεία υποβολής με **json** μορφότυπο.
+--------------------------------+------------------------------------------------------------------+-------------------------------------------------------------------+---------------------------------------------------------------+
| Κατηγορία                      | Δομή                                                             | Υπόδειγμα Excel                                                   | JSON Schema                                                   |
+================================+==================================================================+===================================================================+===============================================================+
| :doc:`REF <backend/ref>`       | :download:`REF </_files/backend/model/REF_DATAMODEL.xlsx>`       | :download:`REF</_files/backend/template/REF_TEMPLATE.xlsx>`       | :download:`REF</_files/backend/schema/REF_SCHEMA.json>`       |
+--------------------------------+------------------------------------------------------------------+-------------------------------------------------------------------+---------------------------------------------------------------+
| :doc:`BSI <backend/bsi>`       | :download:`BSI </_files/backend/model/BSI_DATAMODEL.xlsx>`       | :download:`BSI</_files/backend/template/BSI_TEMPLATE.xlsx>`       | :download:`BSI</_files/backend/schema/BSI_SCHEMA.json>`       |
+--------------------------------+------------------------------------------------------------------+-------------------------------------------------------------------+---------------------------------------------------------------+
| :doc:`INCOME <backend/income>` | :download:`INCOME </_files/backend/model/INCOME_DATAMODEL.xlsx>` | :download:`INCOME</_files/backend/template/INCOME_TEMPLATE.xlsx>` | :download:`INCOME</_files/backend/schema/INCOME_SCHEMA.json>` |
+--------------------------------+------------------------------------------------------------------+-------------------------------------------------------------------+---------------------------------------------------------------+

Οι διαστάσεις του κάθε πίνακα των εισερχόμενων στοιχείων της βάσης
περιλαμβάνουν τις τρεις διαστάσεις που καθορίζουν την πηγή (SOURCE_ORG,
SOURCE_PSN, SOURCE_TYPE) καθώς και τις διαστάσεις που ορίζει το DATA MODEL για
κάθε πίνακα.
