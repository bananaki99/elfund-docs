DBDat
=====

Το **DBDat** αποτελεί τη δομή δεδομένων μέσω της οποίας όλα τα υποβαλλόμενα
στοιχεία εισάγονται στη **Backend Database** με την προϋπόθεση ότι πληρούν
κρίσιμους ελέγχους αλλά και τη δομή δεδομένων με την οποία αρμόδιοι υπάλληλοι
της ΤτΕ θα μπορούν να φορτώνουν απευθείας στοιχεία.

Στο :download:`DATA_MODEL </_static/structure/DBDAT_DATAMODEL.xlsx>` παρουσιάζεται η δομή του σχήματος δεδομένων **DBDat**.

Το :download:`JSON_SCHEMA </_static/structure/DBDAT_SCHEMA.json>` σχήμα για την
υποβολή αρχείων με βάση το **DATA_MODEL** σε μορφή **json** έχει αναπτυχθεί
σύμφωνα με τα πρότυπα :xref:`json_schema_core` και :xref:`json_schema_validation`.  

Με το αρχείο :download:`EXCEL_TEMPLATE
</_static/structure/DBDAT_TEMPLATE.xlsx>` γίνεται η υποβολή στοιχείων **DBDat**
σε μορφή **Excel**.


Τρόπος υποβολής των αρχείων από αρμόδιους χρήστες της ΤτΕ
---------------------------------------------------------

Τα αρχεία υποβάλλονται μέσω του πληροφοριακού συστήματος :xref:`iris` είτε μέσω
API είτε μέσω GUI.  Για κάθε αρχείο που υποβάλλει ένας χρήστης θα λαμβάνει ένα
απαντητικό αρχείο σχετικά με το αν το αρχείο παρελήφθη καθώς επίσης και την
ονομασία του αρχείου που χρησιμοποίησε η Τράπεζα της Ελλάδος για να το
αποθηκεύσει. Η ονομασία του αρχείου ακολουθεί τον ακόλουθο μορφότυπο
``F{ID}DBDAT_{USER}_{NAME}`` όπου: 

* ID είναι ένας μοναδικός ακέραιος αριθμός εισερχόμενου αρχείου μάκρους δέκα
  χαρακτήρων με πρόθεμα το 0 ο οποίος ξεκινάει από το τον αριθμό 1 και
  αυξάνεται κατά ένα κάθε φορά που υποβάλλεται νέο αρχείο

* NAME είναι η αρχική ονομασία του εισερχόμενου αρχείου
* USER είναι ο αναγνωριστικός κωδικός του χρήστη στην ΤτΕ.  

Για παράδειγμα ένα εισερχόμενο αρχείο με ονομασία **data_submission.xlsx** από
τον χρήστη **aloumiotis** με ID 5 μετονομάζεται σε
``F0000000005DBDAT_aloumiotis_data_submission.xlsx``.

Οι μορφότυποι των εισερχόμενων αρχείων της δομής **DBDat** είναι οι ακόλουθοι: 

i. Αρχεία μορφής ``.json``.  Το αρχείο θα πρέπει να δομείται σύμφωνα με το
   :download:`DBDat JSON Schema </_static/structure/DBDAT_SCHEMA.json>`.

#. Αρχεία μορφής ``.xlsx`` με βάση το :download:`υπόδειγμα <_static/structure/DBDAT_TEMPLATE.xlsx>`.

#. Αρχεία μορφής ``.zip``.  Το αρχείο θα πρέπει να περιέχει ως περιεχόμενο μόνο ένα αρχείο με μία από τις παραπάνω μορφές (xlsx, json).


Εισαγωγή στοιχείων στη βάση
---------------------------
Τα στοιχεία θα πρέπει να είναι δυνατό να εισάγονται στη βάση είτε σειριακά είτε ομαδικά.

Σειριακή αποθήκευση
~~~~~~~~~~~~~~~~~~~
Ως σειριακή αποθήκευση νοείται ότι για κάθε αρχείο που ανεβαίνει στο IRIS είτε
αυτό είναι δομής IFDat είτε δομής DBDat επεξεργάζεται αυτόνομα και ανεβαίνουν
τα στοιχεία στη βάση ξεχωριστά και αποστέλεται ξεχωριστό acknowledgment report
για το συγκεκριμένο αρχείο.

Ομαδική αποθήκευση
~~~~~~~~~~~~~~~~~~
Ως ομαδική αποθήκευση νοείται η πολλαπλή επεξεργασία αρχείων που έχουν ανεβεί
στο IRIS και ταυτόχρονη αποθήκευση τους στη βάση δεδομένων.  Τέλος για καϑε
χρήστη αποστέλλεται acknowledgment report για όλα μαζί τα αρχεία του χρήστη που
επεξεργάστηκαν.

Κανόνες αποθήκευσης
~~~~~~~~~~~~~~~~~~~
Θα συμπληρωθεί

